<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="icon" href="/assets/images/logo.png"><title>Forget NodeJS! Build native TypeScript applications with Deno 🦖 | Technorage</title><meta name="generator" content="Jekyll v4.1.1"><meta property="og:title" content="Forget NodeJS! Build native TypeScript applications with Deno 🦖"><meta name="author" content="deepu"><meta property="og:locale" content="en_US"><meta name="description" content="Deno is a modern JavaScript/TypeScript runtime &amp; scripting environment. It is what NodeJS should have been according to Ryan Dahl who created both tools"><meta property="og:description" content="Deno is a modern JavaScript/TypeScript runtime &amp; scripting environment. It is what NodeJS should have been according to Ryan Dahl who created both tools"><link rel="canonical" href="https://deepu.tech/deno-runtime-for-typescript/"><meta property="og:url" content="https://deepu.tech/deno-runtime-for-typescript/"><meta property="og:site_name" content="Technorage"><meta property="og:type" content="article"><meta property="article:published_time" content="2020-02-18T00:00:00+01:00"><meta name="twitter:card" content="summary"><meta property="twitter:title" content="Forget NodeJS! Build native TypeScript applications with Deno 🦖"><script type="application/ld+json">{"author":{"@type":"Person","name":"deepu"},"description":"Deno is a modern JavaScript/TypeScript runtime &amp; scripting environment. It is what NodeJS should have been according to Ryan Dahl who created both tools","@type":"BlogPosting","headline":"Forget NodeJS! Build native TypeScript applications with Deno 🦖","dateModified":"2020-02-18T00:00:00+01:00","datePublished":"2020-02-18T00:00:00+01:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://deepu.tech/assets/images/logo.png"},"name":"deepu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://deepu.tech/deno-runtime-for-typescript/"},"url":"https://deepu.tech/deno-runtime-for-typescript/","@context":"https://schema.org"}</script><link rel="canonical" href="https://deepu.tech/deno-runtime-for-typescript/"><meta property="og:url" content=""><meta name="monetization" content="$ilp.uphold.com/Aw7eGpxKNyK7"><meta name="twitter:site" content="@deepu105"><meta name="twitter:creator" content="@deepu105"><meta name="twitter:title" content="Forget NodeJS! Build native TypeScript applications with Deno 🦖"><meta name="twitter:description" content="Deno is a modern JavaScript/TypeScript runtime & scripting environment. It is what NodeJS should have been according to Ryan Dahl who created both tools"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://i.imgur.com/0FWtns5.jpg"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha256-L/W5Wfqfa0sdBNIKN9cG6QA5F2qx4qICmU2VgLruv9Y=" crossorigin="anonymous"><link href="/assets/css/screen.css" rel="stylesheet"><link href="/assets/css/main.css" rel="stylesheet"></head><body class="layout-post"><noscript id="deferred-styles"><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css" crossorigin="anonymous"></noscript><nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down pr-md-0 pl-md-0"><div class="container d-flex align-items-center"><a class="navbar-brand" href="/"><h2 class="sitetitle">Technorage</h2><small class="sitetitlesub">Where I rage about technology and stuff! </small></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarMediumish"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/">About</a></li><li class="nav-item active"><a class="nav-link" href="/blogs/"><i class="fas fa-blog"></i> Blog</a></li><li class="nav-item"><a class="nav-link" href="/books"><i class="fas fa-book"></i> Books</a></li><li class="nav-item"><a target="_blank" class="nav-link" href="https://www.youtube.com/playlist?list=PLxayiD7e52nPpb-sSaoOPc-zXGhmOaNHK"><i class="fab fa-youtube"></i> Videos</a></li><li class="nav-item"><a target="_blank" class="nav-link" href="https://speakerdeck.com/deepu105"><i class="fab fa-speaker-deck"></i> Presentations</a></li><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.slim.min.js" integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js" integrity="sha256-34Si1Y6llMBKM3G0jQILVeoQKEwuxjbk4zGWXXMT4ps=" crossorigin="anonymous"></script><style>.lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}</style><form class="bd-search" onsubmit="return lunr_search(document.getElementById('lunrsearch').value);"><input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."></form><div id="lunrsearchresults"><ul></ul></div><script src="/assets/js/lunrsearchengine.js"></script></ul></div></div></nav><div class="site-content"><div class="container"><div class="main-content"><div class="container mt-5"><div class="row"><div class="col-lg-2 pl-0"><div class="sticky-top sticky-top-offset"><div class="popover-wrapper d-none d-lg-block"><a href="#"><h2 class="popover-title"><i class="fas fa-stream fa-lg"></i> TOC</h2></a><div class="popover-content"><div class="toc lead"><h3 class="font-weight-bold">Summary</h3><ul><li><a href="#install-deno">Install Deno</a></li><li><a href="#features">Features</a><ul><li><a href="#typescript-support">TypeScript support</a></li><li><a href="#remote-script-execution">Remote script execution</a></li><li><a href="#secure-by-default">Secure by default</a></li><li><a href="#standard-modules">Standard modules</a></li><li><a href="#es-modules">ES Modules</a></li><li><a href="#built-in-tooling">Built-in tooling</a></li><li><a href="#browser-compatibility">Browser compatibility</a></li><li><a href="#promise-api">Promise API</a></li><li><a href="#top-level-await">Top-level <code class="language-plaintext highlighter-rouge">await</code></a></li><li><a href="#subprocess-using-web-workers">Subprocess using web workers</a></li><li><a href="#webassembly-support">WebAssembly support</a></li></ul></li><li><a href="#a-deno-application-in-action">A Deno application in action</a></li><li><a href="#conclusion">Conclusion</a><ul><li><a href="#why-is-deno-better-than-nodejs">Why is Deno better than NodeJS</a></li><li><a href="#why-does-it-matter">Why does it matter</a></li><li><a href="#challenges">Challenges</a></li></ul></li></ul></div></div></div><div class="share"><p>Share</p><ul><li class="ml-1 mr-1"><a target="_blank" href="https://twitter.com/intent/tweet?text=Forget NodeJS! Build native TypeScript applications with Deno 🦖 by @deepu105 &url=https://deepu.tech/deno-runtime-for-typescript/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter"><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://deepu.tech/deno-runtime-for-typescript/" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=435');return false;" title="Linkedin"><i class="fab fa-linkedin-in"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://news.ycombinator.com/submitlink?u=https://deepu.tech/deno-runtime-for-typescript/&t=Forget NodeJS! Build native TypeScript applications with Deno 🦖" onclick="window.open(this.href, 'hackernews-share', 'width=550,height=435');return false;" title="Hacker News"><i class="fab fa-hacker-news-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.reddit.com/submit?url=https://deepu.tech/deno-runtime-for-typescript/&title=Forget NodeJS! Build native TypeScript applications with Deno 🦖" onclick="window.open(this.href, 'reddit-share', 'width=550,height=435');return false;" title="Reddit"><i class="fab fa-reddit-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://facebook.com/sharer.php?u=https://deepu.tech/deno-runtime-for-typescript/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;" title="Facebook"><i class="fab fa-facebook-f"></i></a></li></ul><div class="sep"></div><ul><li><script type="text/javascript">var HYVOR_TALK_WEBSITE = 4123;</script><script async type="text/javascript" src="//talk.hyvor.com/web-api/count/"></script><span data-talk-id="https://deepu.tech/deno-runtime-for-typescript/"></span></li></ul></div><div class="ad-vertical-md"><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3I&placement=deeputech" id="_carbonads_js"></script></div></div></div><div class="col-lg-9 flex-first flex-lg-unordered"><div class="mainheading"><h1 class="posttitle">Forget NodeJS! Build native TypeScript applications with Deno 🦖</h1><img data-src="https://i.imgur.com/0FWtns5.jpg" alt="Forget NodeJS! Build native TypeScript applications with Deno 🦖" class="featured-image img-fluid lozad" src="/assets/images/placeholder.jpg"><div class="row post-top-meta"><div class="col-12 text-center text-md-left mb-4 mb-md-0"><img class="author-thumb lozad" src="/assets/images/placeholder.jpg" data-src="https://www.gravatar.com/avatar/7f408bc67dc9ae3b288ee92d16d3c4c2?s=250&d=mm&r=x" alt="Deepu K Sasidharan"> <a target="_blank" class="link-dark" href="https://www.deepu.tech">Deepu K Sasidharan</a><a target="_blank" href="https://twitter.com/deepu105" class="btn follow">Follow</a><span class="separator d-none d-md-inline-block">| </span><span class="author-description"><small><time class="post-date" datetime="2020-02-18">18 Feb 2020</time> </small><span class="separator d-inline-block">| </span><small>10 mins read </small><span class="separator d-inline-block d-lg-none">| </span><span class="d-inline-block d-lg-none"><div class="share" style="margin-top: 0;"><ul><li class="ml-1 mr-1"><a target="_blank" href="https://twitter.com/intent/tweet?text=Forget NodeJS! Build native TypeScript applications with Deno 🦖 by @deepu105 &url=https://deepu.tech/deno-runtime-for-typescript/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Twitter"><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://deepu.tech/deno-runtime-for-typescript/" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=435');return false;" title="Linkedin"><i class="fab fa-linkedin-in"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://news.ycombinator.com/submitlink?u=https://deepu.tech/deno-runtime-for-typescript/&t=Forget NodeJS! Build native TypeScript applications with Deno 🦖" onclick="window.open(this.href, 'hackernews-share', 'width=550,height=435');return false;" title="Hacker News"><i class="fab fa-hacker-news-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.reddit.com/submit?url=https://deepu.tech/deno-runtime-for-typescript/&title=Forget NodeJS! Build native TypeScript applications with Deno 🦖" onclick="window.open(this.href, 'reddit-share', 'width=550,height=435');return false;" title="Reddit"><i class="fab fa-reddit-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://facebook.com/sharer.php?u=https://deepu.tech/deno-runtime-for-typescript/" onclick="window.open(this.href, 'facebook-share', 'width=550,height=435');return false;" title="Facebook"><i class="fab fa-facebook-f"></i></a></li></ul></div></span></span></div></div></div><div class="article-post"><p>Have you heard of <a href="https://deno.land/">Deno</a>? If not you should check it out. Deno is a modern JavaScript/TypeScript runtime &amp; scripting environment. Deno is what NodeJS should have been according to Ryan Dahl who created NodeJS. Deno was also created by Ryan Dahl in 2018 and is built with <a href="https://v8.dev/">V8</a>, <a href="https://www.rust-lang.org/">Rust</a> and <a href="https://github.com/tokio-rs/tokio">Tokio</a> with a focus on security, performance, and ease of use. Deno takes many inspirations from Go and Rust.</p><p>In this post let us see what Deno offers and how it compares to NodeJS. You can also watch the same in a talk format I did for Devoxx Ukraine below</p><p></p><div class="embed-video-container"><iframe class="lozad" width="710" height="399" data-src="https://www.youtube.com/embed/8LZ0JmalhZE " allowfullscreen=""></iframe></div><p></p><p>Let us install Deno before we proceed.</p><h1 id="install-deno">Install Deno</h1><p>There are multiple ways to install Deno. If you are on Mac or Linux, you can install it via <a href="https://formulae.brew.sh/formula/deno">Homebrew</a>. On Windows, you can use <a href="https://chocolatey.org/packages/deno">Chocolatey</a>.</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="c"># Mac/Linux</span>
brew <span class="nb">install </span>deno

<span class="c"># windows</span>
choco <span class="nb">install </span>deno
</pre></td></tr></tbody></table></code></pre></div></div><p>Check <a href="https://deno.land/std/manual.md#setup">the official doc</a> for other installation methods</p><blockquote><p>Please note that Deno is still under active development and hence may not be ready for production use</p></blockquote><p>Now that we have Deno installed, let us look at its features.</p><h1 id="features">Features</h1><ul><li>TypeScript supported out of the box without any transpiling setup</li><li>Can execute remote scripts</li><li>Secure by default. No file, network, or environment access by default unless explicitly enabled</li><li>Provides curated standard modules</li><li>Supports only ES modules. Modules are cached globally and are immutable</li><li>Built-in tooling (format, lint, test, bundle and so on)</li><li>Deno applications can be browser compatible</li><li>Promise based API(<code class="language-plaintext highlighter-rouge">async/await</code> supported) and no callback hell</li><li>Top-level <code class="language-plaintext highlighter-rouge">await</code> support</li><li>Sub-process using web workers</li><li>WebAssembly support</li><li>Lightweight multi-platform executable(~10MB)</li></ul><blockquote><p>Deno does not use NPM for dependency management and hence there is no <code class="language-plaintext highlighter-rouge">node_modules</code> hell to deal with, which IMO is a huge selling point</p></blockquote><p><img src="https://i.imgur.com/0FWtns5.jpg" alt="shut up and take my money"></p><h2 id="typescript-support">TypeScript support</h2><p>Deno has native support for TypeScript and JavaScript. You can write Deno applications directly in TypeScript and Deno can execute them without any transpiling step from your side. Let us try it</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">hello</span><span class="p">(</span><span class="nx">person</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="dl">"</span><span class="s2">Hello, </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">person</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">hello</span><span class="p">(</span><span class="dl">"</span><span class="s2">John</span><span class="dl">"</span><span class="p">));</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Save this to <code class="language-plaintext highlighter-rouge">hello.ts</code> file and execute <code class="language-plaintext highlighter-rouge">deno hello.ts</code>. You will see Deno compiles the file and executes it.</p><p>Deno supports the latest version of TypeScript and keeps the support up to date.</p><h2 id="remote-script-execution">Remote script execution</h2><p>With Deno, you can run a local or remote script quite easily. Just point to the file or HTTP URL of the script and Deno will download and execute it</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>deno https://deno.land/std/examples/welcome.ts
</pre></td></tr></tbody></table></code></pre></div></div><p>This means you can just point to a raw GitHub URL to execute a script, no hassle of installing something. The default security model Deno is applied to remote scripts as well.</p><h2 id="secure-by-default">Secure by default</h2><p>By default, a script run with Deno cannot access the file system, network, sub-process, or environment. This creates a sandbox for the script and the user has to explicitly provide permissions. This puts control in the hands of the end-user.</p><ul><li>Granular permissions</li><li>Permissions can be revoked</li><li>Permissions whitelist support</li></ul><p>The permissions can be provided via command-line flags during execution or programmatically when using sub-processes.</p><p>The available flags are:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>--allow-all | -A
--allow-env
--allow-hrtime
--allow-read=&lt;whitelist&gt;
--allow-write=&lt;whitelist&gt;
--allow-net=&lt;whitelist&gt;
--allow-plugin
--allow-run
</pre></td></tr></tbody></table></code></pre></div></div><blockquote><p>Please note that flags must be passed before the filename like <code class="language-plaintext highlighter-rouge">deno -A file.ts</code> or <code class="language-plaintext highlighter-rouge">deno run -A file.ts</code>. Anything passed after the filename will be considered as program arguments.</p></blockquote><p>Let us see an example that creates a local HTTP server:</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello there!</span><span class="dl">"</span><span class="p">);</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">serve</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/http/server.ts</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">serve</span><span class="p">(</span><span class="dl">"</span><span class="s2">:8000</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="dl">"</span><span class="s2">Server created!</span><span class="dl">"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>The snippet tries to use the network and hence when you run the program with Deno it will fail with an error</p><p>To avoid the error we need to pass the <code class="language-plaintext highlighter-rouge">--allow-net</code> or <code class="language-plaintext highlighter-rouge">--allow-all</code> flag when running the program. You can also grant access to specific ports and domains as well using a whitelist. For example <code class="language-plaintext highlighter-rouge">deno --allow-net=:8000 security.ts</code></p><p><img src="https://i.imgur.com/nVgPoIl.png" alt="deno security no prompt"></p><h2 id="standard-modules">Standard modules</h2><p>Deno provides <a href="https://deno.land/std/">standard modules</a> like NodeJS, Go or Rust. The list is growing as newer versions are released. Currently available modules are:</p><ul><li><code class="language-plaintext highlighter-rouge">archive</code> - TAR archive handling</li><li><code class="language-plaintext highlighter-rouge">colors</code> - ANSI colors on console</li><li><code class="language-plaintext highlighter-rouge">datetime</code> - Datetime parse utilities</li><li><code class="language-plaintext highlighter-rouge">encoding</code> - Encode/Decode CSV, YAML, HEX, Base32 &amp; TOML</li><li><code class="language-plaintext highlighter-rouge">flags</code> - CLI argument parser</li><li><code class="language-plaintext highlighter-rouge">fs</code> - Filesystem API</li><li><code class="language-plaintext highlighter-rouge">http</code> - HTTP server framework</li><li><code class="language-plaintext highlighter-rouge">log</code> - Logging framework</li><li><code class="language-plaintext highlighter-rouge">media_types</code> - Resolve media types</li><li><code class="language-plaintext highlighter-rouge">prettier</code> - Prettier formatting API</li><li><code class="language-plaintext highlighter-rouge">strings</code> - String utils</li><li><code class="language-plaintext highlighter-rouge">testing</code> - Testing utils</li><li><code class="language-plaintext highlighter-rouge">uuid</code> - UUID support</li><li><code class="language-plaintext highlighter-rouge">ws</code> - Websocket client/server</li></ul><p>The standard modules are available under <code class="language-plaintext highlighter-rouge">https://deno.land/std</code> namespace and are tagged in accordance with Deno releases.</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">green</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/fmt/colors.ts</span><span class="dl">"</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div><h2 id="es-modules">ES Modules</h2><p>Deno supports only <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">ES Modules</a> using a remote or local URL. This keeps dependency management simple and light. Unlike NodeJS, Deno doesn’t try to be too smart here, which means:</p><ul><li><code class="language-plaintext highlighter-rouge">require()</code> is not supported, so no confusion with import syntax</li><li>No “magical” module resolution</li><li>Third-party modules are imported by URL(Local and remote)</li><li>Remote code is fetched only once and cached globally for later use</li><li>Remote code is considered immutable and never updated unless <code class="language-plaintext highlighter-rouge">--reload</code> flag is used</li><li>Dynamic imports are supported</li><li>Supports <a href="https://deno.land/std/manual.md#import-maps">import maps</a></li><li>Third-party modules are available in <a href="https://deno.land/x/">https://deno.land/x/</a></li><li>NPM modules can be used, if required, as simple local file URL or from <a href="https://jspm.io/">jspm.io</a> or <a href="https://www.pika.dev/">pika.dev</a></li></ul><p>Hence we can any import any library that is available from a URL. Let’s build on our HTTP server example</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">serve</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/http/server.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">green</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://raw.githubusercontent.com/denoland/deno/master/std/fmt/colors.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">capitalize</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://unpkg.com/lodash-es@4.17.15/capitalize.js</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">serve</span><span class="p">(</span><span class="dl">"</span><span class="s2">:8000</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">green</span><span class="p">(</span><span class="nx">capitalize</span><span class="p">(</span><span class="dl">"</span><span class="s2">server created!</span><span class="dl">"</span><span class="p">)));</span>

<span class="kd">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">().</span><span class="nx">encode</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello there</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">green</span><span class="p">(</span><span class="dl">"</span><span class="s2">Listening on http://localhost:8000/</span><span class="dl">"</span><span class="p">));</span>
  <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">req</span> <span class="k">of</span> <span class="nx">server</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">respond</span><span class="p">({</span> <span class="nx">body</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>The import paths can be made nicer by using an import map below</p><div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
  </span><span class="nl">"imports"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"http/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://deno.land/std/http/"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"fmt/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/denoland/deno/master/std/fmt/"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"lodash/"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://unpkg.com/lodash-es@4.17.15/"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div><p>Now we can simplify the paths as below</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">serve</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">http/server.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">green</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">fmt/colors.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">capitalize</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">lodash/capitalize.js</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">serve</span><span class="p">(</span><span class="dl">"</span><span class="s2">:8000</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">green</span><span class="p">(</span><span class="nx">capitalize</span><span class="p">(</span><span class="dl">"</span><span class="s2">server created!</span><span class="dl">"</span><span class="p">)));</span>

<span class="kd">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextEncoder</span><span class="p">().</span><span class="nx">encode</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello there</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">green</span><span class="p">(</span><span class="dl">"</span><span class="s2">Listening on http://localhost:8000/</span><span class="dl">"</span><span class="p">));</span>
  <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">req</span> <span class="k">of</span> <span class="nx">server</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">respond</span><span class="p">({</span> <span class="nx">body</span> <span class="p">});</span>
  <span class="p">}</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Run this with the <code class="language-plaintext highlighter-rouge">--importmap</code> flag <code class="language-plaintext highlighter-rouge">deno --allow-net=:8000 --importmap import-map.json server.ts</code>. Please note that the flags should be before the filename. Now you can access <code class="language-plaintext highlighter-rouge">http://localhost:8000</code> to verify this.</p><h2 id="built-in-tooling">Built-in tooling</h2><p>Deno takes inspiration from Rust and Golang to provide built-in tooling, this IMO is great as it helps you get started without having to worry about setting up testing, linting and bundling frameworks. The below are tools currently available/planned</p><ul><li>Dependency inspector (<code class="language-plaintext highlighter-rouge">deno info</code>): Provides information about cache and source files</li><li>Bundler (<code class="language-plaintext highlighter-rouge">deno bundle</code>): Bundle module and dependencies into a single JavaScript file</li><li>Installer (<code class="language-plaintext highlighter-rouge">deno install</code>): Install a Deno module globally, the equivalent of <code class="language-plaintext highlighter-rouge">npm install</code></li><li><a href="https://github.com/denoland/deno/tree/master/std/testing">Test runner</a> (<code class="language-plaintext highlighter-rouge">deno test</code>): Run tests using the Deno built-in test framework</li><li>Type info (<code class="language-plaintext highlighter-rouge">deno types</code>): Get the Deno TypeScript API reference</li><li>Code formatter (<code class="language-plaintext highlighter-rouge">deno fmt</code>): Format source code using Prettier</li><li>Linter (planned) (<code class="language-plaintext highlighter-rouge">deno lint</code>): Linting support for source code</li><li>Debugger (planned) (<code class="language-plaintext highlighter-rouge">--debug</code>): Debug support for Chrome Dev tools</li></ul><p>For example, with Deno, you can write test cases easily using provided utilities</p><p>Let’s say we have <code class="language-plaintext highlighter-rouge">factorial.ts</code></p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">function</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span><span class="p">:</span> <span class="kr">number</span><span class="p">):</span> <span class="kr">number</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="nx">n</span> <span class="o">*</span> <span class="nx">factorial</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>We can write a test for this as below</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">test</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/testing/mod.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">assertEquals</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/testing/asserts.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">factorial</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./factorial.ts</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">test</span><span class="p">(</span><span class="kd">function</span> <span class="nx">testFactorial</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
  <span class="nx">assertEquals</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">120</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">test</span><span class="p">(</span><span class="kd">function</span> <span class="nx">t2</span><span class="p">():</span> <span class="k">void</span> <span class="p">{</span>
  <span class="nx">assertEquals</span><span class="p">(</span><span class="dl">"</span><span class="s2">world</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">worlds</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div><h2 id="browser-compatibility">Browser compatibility</h2><p>Deno programs or modules can be run on a browser as well if they satisfy the below conditions</p><ul><li>The program must are written completely in JavaScript and should not use the global Deno APIs</li><li>If the program is written in Typescript, it must be bundled as JavaScript using <code class="language-plaintext highlighter-rouge">deno bundle</code> and should not use the global Deno APIs</li></ul><p>For browser compatibility Deno also supports <code class="language-plaintext highlighter-rouge">window.load</code> and <code class="language-plaintext highlighter-rouge">window.unload</code> events. <code class="language-plaintext highlighter-rouge">load</code> and <code class="language-plaintext highlighter-rouge">unload</code> events can be used with <code class="language-plaintext highlighter-rouge">window.addEventListener</code> as well.</p><p>Let us see below sample, this can be run using <code class="language-plaintext highlighter-rouge">deno run</code> or we can package it and execute in a browser</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="nx">capitalize</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://unpkg.com/lodash-es@4.17.15/capitalize.js</span><span class="dl">"</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">capitalize</span><span class="p">(</span><span class="dl">"</span><span class="s2">hello from the web browser</span><span class="dl">"</span><span class="p">));</span>
<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">capitalize</span><span class="p">(</span><span class="dl">"</span><span class="s2">module loaded!</span><span class="dl">"</span><span class="p">));</span>
<span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>We can package this using <code class="language-plaintext highlighter-rouge">deno bundle example.ts browser_compatibility.js</code> and use the <code class="language-plaintext highlighter-rouge">browser_compatibility.js</code> in an HTML file and load it in a browser. Try it out and look at the browser console.</p><h2 id="promise-api">Promise API</h2><p>Another great thing about Deno is that all of its API is <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a> based which means, unlike NodeJS we do not have to deal with callback hells. Also, the API is quite consistent across standard modules. Let us see an example:</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">filePromise</span><span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Deno</span><span class="p">.</span><span class="nx">File</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">dummyFile.txt</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">filePromise</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">file</span><span class="p">:</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">File</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">Deno</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">Deno</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="nx">file</span><span class="p">).</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">file</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
  <span class="p">});</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>But we said no callbacks right, the good thing about Promise API is that we can use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">async/await</a> syntax, so with that, we can rewrite above</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">filePromise</span><span class="p">:</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Deno</span><span class="p">.</span><span class="nx">File</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">"</span><span class="s2">dummyFile.txt</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">filePromise</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">file</span><span class="p">:</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">File</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">Deno</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="nx">file</span><span class="p">);</span>
  <span class="nx">file</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">});</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Run <code class="language-plaintext highlighter-rouge">deno -A example.ts</code> to see it in action, don’t forget to create the <code class="language-plaintext highlighter-rouge">dummyFile.txt</code> with some content</p><h2 id="top-level-await">Top-level <code class="language-plaintext highlighter-rouge">await</code></h2><p>The above code still uses a callback, what if we can use <code class="language-plaintext highlighter-rouge">await</code> for that as well, luckily Deno has support for the <a href="https://github.com/tc39/proposal-top-level-await">top-level <code class="language-plaintext highlighter-rouge">await</code></a> proposal(Not supported by TypeScript yet). With this, we can rewrite the above</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">fileName</span> <span class="o">=</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">file</span><span class="p">:</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">File</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">fileName</span><span class="p">);</span>

<span class="k">await</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">Deno</span><span class="p">.</span><span class="nx">stdout</span><span class="p">,</span> <span class="nx">file</span><span class="p">);</span>

<span class="nx">file</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Isn’t that neat? Run it as <code class="language-plaintext highlighter-rouge">deno -A example.ts dummyFile.txt</code></p><h2 id="subprocess-using-web-workers">Subprocess using web workers</h2><p>Since Deno uses the V8 engine which is single-threaded, we have to use a sub-process like in NodeJS to spawn new threads(V8 instance). This is done using service workers in Deno. Here is an example, we are importing the code we used in the top-level <code class="language-plaintext highlighter-rouge">await</code> example in the subprocess here.</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">run</span><span class="p">({</span>
  <span class="na">args</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">deno</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">run</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">--allow-read</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">top_level_await.ts</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">dummyFile.txt</span><span class="dl">"</span><span class="p">],</span>
  <span class="na">stdout</span><span class="p">:</span> <span class="dl">"</span><span class="s2">piped</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">stderr</span><span class="p">:</span> <span class="dl">"</span><span class="s2">piped</span><span class="dl">"</span><span class="p">,</span>
<span class="p">});</span>

<span class="kd">const</span> <span class="p">{</span> <span class="nx">code</span> <span class="p">}</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">p</span><span class="p">.</span><span class="nx">status</span><span class="p">();</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">code</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">rawOutput</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">p</span><span class="p">.</span><span class="nx">output</span><span class="p">();</span>
  <span class="k">await</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">stdout</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">rawOutput</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">rawError</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">p</span><span class="p">.</span><span class="nx">stderrOutput</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">errorString</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TextDecoder</span><span class="p">().</span><span class="nx">decode</span><span class="p">(</span><span class="nx">rawError</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">errorString</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">Deno</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">code</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>You can run any CMD/Unix command as a subprocess like in NodeJS</p><h2 id="webassembly-support">WebAssembly support</h2><p><a href="https://webassembly.org/">WebAssembly</a> is one of the most innovative features to have landed on the JavaScript world. It lets us use programs written in any compatible language to be executed in a JS Engine. Deno has native support for WebAssembly. Let us see an example.</p><p>First, we need a WebAssembly(WASM) binary. Since we are focusing on Deno here, let’s use a simple C program. You can also use Rust, Go or any other <a href="https://github.com/appcypher/awesome-wasm-langs">supported language</a>. In the end, you just need to provide a compiled <code class="language-plaintext highlighter-rouge">.wasm</code> binary file.</p><div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">factorial</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">return</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">n</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>We can convert this to WASM binary using the online converter <a href="https://wasdk.github.io/WasmFiddle/?pkku4">here</a> and import it in our TypeScript program below</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">mod</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">Module</span><span class="p">(</span><span class="k">await</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="dl">"</span><span class="s2">fact_c.wasm</span><span class="dl">"</span><span class="p">));</span>
<span class="kd">const</span> <span class="p">{</span>
  <span class="na">exports</span><span class="p">:</span> <span class="p">{</span> <span class="nx">factorial</span> <span class="p">},</span>
<span class="p">}</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebAssembly</span><span class="p">.</span><span class="nx">Instance</span><span class="p">(</span><span class="nx">mod</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Run <code class="language-plaintext highlighter-rouge">deno -A example.ts</code> and see the output from the C program.</p><hr><h1 id="a-deno-application-in-action">A Deno application in action</h1><p>Now that we have an overview of Deno features, let’s build a Deno CLI app</p><blockquote><p>Run <code class="language-plaintext highlighter-rouge">deno --help</code> and <code class="language-plaintext highlighter-rouge">deno run --help</code> to see all options that can be passed when you run a program. You can learn more about Deno features and API in the Deno <a href="https://deno.land/">website</a> and <a href="https://deno.land/std/manual.md">manual</a></p></blockquote><p>Let’s build a simple proxy server that can be installed as a CLI tool. This is a really simple proxy, but you can add more features to make it smarter if you like</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre><span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="dl">"</span><span class="s2">Proxy server starting!</span><span class="dl">"</span><span class="p">);</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">serve</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/http/server.ts</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">green</span><span class="p">,</span> <span class="nx">yellow</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">https://deno.land/std/fmt/colors.ts</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">serve</span><span class="p">(</span><span class="dl">"</span><span class="s2">:8000</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">Deno</span><span class="p">.</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">||</span> <span class="dl">"</span><span class="s2">https://deepu.tech</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="nx">green</span><span class="p">(</span><span class="dl">"</span><span class="s2">proxy server created!</span><span class="dl">"</span><span class="p">));</span>

<span class="p">(</span><span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">green</span><span class="p">(</span><span class="s2">`</span><span class="err">Proxy listening on http://localhost:8000/ for </span><span class="p">${</span><span class="nx">url</span><span class="p">}</span><span class="s2">`</span><span class="p">));</span>

  <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">req</span> <span class="k">of</span> <span class="nx">server</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">reqUrl</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="dl">"</span><span class="s2">http</span><span class="dl">"</span><span class="p">)</span> <span class="p">?</span> <span class="nx">req</span><span class="p">.</span><span class="nx">url</span> <span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">url</span><span class="p">}${</span><span class="nx">req</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">yellow</span><span class="p">(</span><span class="s2">`</span><span class="err">URL requested: </span><span class="p">${</span><span class="nx">reqUrl</span><span class="p">}</span><span class="s2">`</span><span class="p">));</span>

    <span class="kd">const</span> <span class="nx">res</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">reqUrl</span><span class="p">);</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">respond</span><span class="p">(</span><span class="nx">res</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">})();</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Run <code class="language-plaintext highlighter-rouge">deno --allow-net deno_app.ts https://google.com</code> and visit <a href="http://localhost:8000/">http://localhost:8000/</a>. You can now see all the traffic on your console. You can use any URL you like instead of Google.</p><p>Lets package and install the app.</p><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>deno <span class="nb">install</span> <span class="nt">--allow-net</span> my-proxy deno_app.ts
</pre></td></tr></tbody></table></code></pre></div></div><p>If you want to override the file use <code class="language-plaintext highlighter-rouge">deno install -f --allow-net my-proxy deno_app.ts</code>. You can also publish the script to an HTTP URL and install it from there.</p><p>Now just run <code class="language-plaintext highlighter-rouge">my-proxy https://google.com</code> and viola we have our own proxy app. Isn’t that simple and neat.</p><hr><h1 id="conclusion">Conclusion</h1><p>Let us see how Deno compares against NodeJS and why I believe it has great potential</p><h2 id="why-is-deno-better-than-nodejs">Why is Deno better than NodeJS</h2><p>I consider Deno to be better than NodeJS for the following reasons. The creator of NodeJS thinks the same I guess</p><ul><li>Easy to install - Single lightweight binary, built-in dependency management</li><li>Secure by default - Sandboxed, Fine-grained privileges and user-controlled</li><li>Simple ES module resolution - No smart(confusing) module system like NodeJS</li><li>Decentralized and globally cached third-party modules - No <code class="language-plaintext highlighter-rouge">node_modules</code> hell, efficient</li><li>No dependency on package managers or package registries(No NPM, No Yarn, No <code class="language-plaintext highlighter-rouge">node_modules</code>)</li><li>Native TypeScript support</li><li>Follows web standards and modern language features</li><li>Browser compatibility - Ability to reuse modules in browser and Deno apps</li><li>Remote script runner - Neat installation of scripts and tools</li><li>Built-in tooling - No hassle of setting up tooling, bundlers and so on</li></ul><h2 id="why-does-it-matter">Why does it matter</h2><p>Why does it matter, why do we need another scripting environment? Isn’t JavaScript ecosystem already bloated enough</p><ul><li>NodeJS ecosystem has become too heavy and bloated and we need something to break the monopoly and force constructive improvements</li><li>Dynamic languages are still important especially in the below domains<ul><li>Data science</li><li>Scripting</li><li>Tooling</li><li>CLI</li></ul></li><li>Many Python/NodeJS/Bash use cases can be replaced with TypeScript using Deno<ul><li>TypeScript provides better developer experience</li><li>Consistent and documentable API</li><li>Easier to build and distribute</li><li>Does not download the internet all the time</li><li>More secure</li></ul></li></ul><h2 id="challenges">Challenges</h2><p>This is not without challenges, for Deno to succeed it still has to overcome these issues</p><ul><li>Fragmentation of libraries and modules</li><li>Not compatible with many of the NPM modules already out there</li><li>Library authors would have to publish a Deno compatible build(Not difficult but en extra step)</li><li>Migrating existing NodeJS apps will not be easy due to incompatible API</li><li>Bundles are not optimized so might need tooling or improvements there</li><li>Stability, since Deno is quite new (NodeJS is battle-tested)</li><li>Not production-ready</li></ul><hr><p>If you like this article, please leave a like or a comment.</p><p>You can follow me on <a href="https://twitter.com/deepu105">Twitter</a> and <a href="https://www.linkedin.com/in/deepu05/">LinkedIn</a>.</p><p>Cover image credit: Random image from the internet</p></div><hr><div class="after-post-cats"><ul class="tags mb-4"></ul></div><div class="after-post-tags"><ul class="tags"><li><a class="smoothscroll" href="/tags#deno">#deno</a></li><li><a class="smoothscroll" href="/tags#javascript">#javascript</a></li><li><a class="smoothscroll" href="/tags#nodejs">#nodejs</a></li><li><a class="smoothscroll" href="/tags#typescript">#typescript</a></li></ul></div><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="prev d-block col-md-6" href="/memory-management-in-golang/">&laquo; 🚀 Visualizing memory management in Golang</a> <a class="next d-block col-md-6 text-lg-right" href="/memory-management-in-rust/">🚀 Visualizing memory management in Rust &raquo;</a><div class="clearfix"></div></div><hr></div></div></div><div class="container"><div id="comments" class="row justify-content-center mb-5"><div class="col-md-8"><section class="hyvor"><div id="hyvor-talk-view"></div><script type="text/javascript">var HYVOR_TALK_WEBSITE = 4123; // DO NOT CHANGE THIS
      var HYVOR_TALK_CONFIG = {
          url: 'https://deepu.tech/deno-runtime-for-typescript/',
          id: 'https://deepu.tech/deno-runtime-for-typescript/'
      };</script><script async type="text/javascript" src="//talk.hyvor.com/web-api/embed"></script></section></div></div></div></div><div class="alertbar"><div class="container text-center"><span>Never miss a <b>story</b> from us, subscribe to our newsletter</span><form action="https://tech.us7.list-manage.com/subscribe/post?u=00729f6c6d6bb180801b9484e&amp;id=f521dede4b" method="post" name="mc-embedded-subscribe-form" id="mc-embedded-subscribe-form" class="wj-contact-form validate" target="_blank" novalidate><div class="mc-field-group"><input type="email" placeholder="Email address" name="EMAIL" class="required email" id="mce-EMAIL" autocomplete="on" required> <input type="submit" value="Subscribe" name="subscribe" class="heart"></div></form></div></div></div><div class="jumbotron fortags lozad" data-background-image="/assets/images/jumbotron.jpg"><div class="d-md-flex h-100"><div class="col-md-4 transpdark align-self-center text-center h-100"><div class="d-md-flex align-items-center justify-content-center h-100"><h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2></div></div><div class="col-md-8 pt-1 ph-2 align-self-center text-center h-100"><a class="mt-1 mb-1" href="/tags#languages">languages (14)</a> <a class="mt-1 mb-1" href="/tags#programming">programming (14)</a> <a class="mt-1 mb-1" href="/tags#javascript">javascript (12)</a> <a class="mt-1 mb-1" href="/tags#beginners">beginners (8)</a> <a class="mt-1 mb-1" href="/tags#java">java (7)</a> <a class="mt-1 mb-1" href="/tags#concurrency">concurrency (6)</a> <a class="mt-1 mb-1" href="/tags#rust">rust (6)</a> <a class="mt-1 mb-1" href="/tags#go">go (5)</a> <a class="mt-1 mb-1" href="/tags#microservices">microservices (5)</a> <a class="mt-1 mb-1" href="/tags#typescript">typescript (5)</a> <a class="mt-1 mb-1" href="/tags#computerscience">computerscience (4)</a> <a class="mt-1 mb-1" href="/tags#functional">functional (4)</a> <a class="mt-1 mb-1" href="/tags#linux">linux (4)</a> <a class="mt-1 mb-1" href="/tags#async">async (3)</a> <a class="mt-1 mb-1" href="/tags#development">development (3)</a> <a class="mt-1 mb-1" href="/tags#fedora">fedora (3)</a> <a class="mt-1 mb-1" href="/tags#jhipster">jhipster (3)</a> <a class="mt-1 mb-1" href="/tags#kubernetes">kubernetes (3)</a> <a class="mt-1 mb-1" href="/tags#thepragmaticprogrammer">thepragmaticprogrammer (3)</a> <a class="mt-1 mb-1" href="/tags#azure">azure (2)</a> <a class="mt-1 mb-1" href="/tags#career">career (2)</a> <a class="mt-1 mb-1" href="/tags#codequality">codequality (2)</a> <a class="mt-1 mb-1" href="/tags#deno">deno (2)</a> <a class="mt-1 mb-1" href="/tags#docker">docker (2)</a> <a class="mt-1 mb-1" href="/tags#garbagecollection">garbagecollection (2)</a> <a class="mt-1 mb-1" href="/tags#gnome">gnome (2)</a> <a class="mt-1 mb-1" href="/tags#node">node (2)</a> <a class="mt-1 mb-1" href="/tags#nodejs">nodejs (2)</a> <a class="mt-1 mb-1" href="/tags#react">react (2)</a> <a class="mt-1 mb-1" href="/tags#showdev">showdev (2)</a> <a class="mt-1 mb-1" href="/tags#webdev">webdev (2)</a> <a class="mt-1 mb-1" href="/tags#architecture">architecture (1)</a> <a class="mt-1 mb-1" href="/tags#bash">bash (1)</a> <a class="mt-1 mb-1" href="/tags#blogging">blogging (1)</a> <a class="mt-1 mb-1" href="/tags#books">books (1)</a> <a class="mt-1 mb-1" href="/tags#clojure">clojure (1)</a> <a class="mt-1 mb-1" href="/tags#codenewbie">codenewbie (1)</a> <a class="mt-1 mb-1" href="/tags#desktop">desktop (1)</a> <a class="mt-1 mb-1" href="/tags#devops">devops (1)</a> <a class="mt-1 mb-1" href="/tags#discuss">discuss (1)</a> <a class="mt-1 mb-1" href="/tags#distributedsystems">distributedsystems (1)</a> <a class="mt-1 mb-1" href="/tags#gaming">gaming (1)</a> <a class="mt-1 mb-1" href="/tags#golang">golang (1)</a> <a class="mt-1 mb-1" href="/tags#ide">ide (1)</a> <a class="mt-1 mb-1" href="/tags#interview">interview (1)</a> <a class="mt-1 mb-1" href="/tags#istio">istio (1)</a> <a class="mt-1 mb-1" href="/tags#Jekyll">Jekyll (1)</a> <a class="mt-1 mb-1" href="/tags#jvm">jvm (1)</a> <a class="mt-1 mb-1" href="/tags#kde">kde (1)</a> <a class="mt-1 mb-1" href="/tags#kotlin">kotlin (1)</a> <a class="mt-1 mb-1" href="/tags#medium">medium (1)</a> <a class="mt-1 mb-1" href="/tags#memory-management">memory-management (1)</a> <a class="mt-1 mb-1" href="/tags#motivation">motivation (1)</a> <a class="mt-1 mb-1" href="/tags#multithreading">multithreading (1)</a> <a class="mt-1 mb-1" href="/tags#ohmyzsh">ohmyzsh (1)</a> <a class="mt-1 mb-1" href="/tags#opensource">opensource (1)</a> <a class="mt-1 mb-1" href="/tags#polyglot">polyglot (1)</a> <a class="mt-1 mb-1" href="/tags#pragmatic">pragmatic (1)</a> <a class="mt-1 mb-1" href="/tags#python">python (1)</a> <a class="mt-1 mb-1" href="/tags#ruby">ruby (1)</a> <a class="mt-1 mb-1" href="/tags#scala">scala (1)</a> <a class="mt-1 mb-1" href="/tags#svelte">svelte (1)</a> <a class="mt-1 mb-1" href="/tags#tech">tech (1)</a> <a class="mt-1 mb-1" href="/tags#terminal">terminal (1)</a> <a class="mt-1 mb-1" href="/tags#terraform">terraform (1)</a> <a class="mt-1 mb-1" href="/tags#ubuntu">ubuntu (1)</a> <a class="mt-1 mb-1" href="/tags#v8">v8 (1)</a> <a class="mt-1 mb-1" href="/tags#vr">vr (1)</a> <a class="mt-1 mb-1" href="/tags#vscode">vscode (1)</a> <a class="mt-1 mb-1" href="/tags#web">web (1)</a> <a class="mt-1 mb-1" href="/tags#WebAssembly">WebAssembly (1)</a> <a class="mt-1 mb-1" href="/tags#webassembly">webassembly (1)</a> <a class="mt-1 mb-1" href="/tags#windows">windows (1)</a> <a class="mt-1 mb-1" href="/tags#womenintech">womenintech (1)</a> <a class="mt-1 mb-1" href="/tags#writing">writing (1)</a> <a class="mt-1 mb-1" href="/tags#zsh">zsh (1)</a></div></div></div><footer class="footer"><div class="container"><div class="row"><div class="col-md-6 col-sm-6 text-center text-lg-left">Copyright © 2021 Deepu K Sasidharan<br><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img class="lozad" alt="Creative Commons License" style="border-width:0" src="/assets/images/placeholder.jpg" data-src="https://i.creativecommons.org/l/by/4.0/88x31.png"> </a>Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div><div class="col-md-6 col-sm-6 text-center text-lg-right"><a target="_blank" href="https://www.wowthemes.net/mediumish-free-jekyll-template/">Mediumish Jekyll Theme</a> by WowThemes.net | Domain by <a href="https://js.org" target="_blank" title="JS.ORG | JavaScript Community"><img src="/assets/images/placeholder.jpg" data-src="https://logo.js.org/dark_tiny.png" style="width:50px" alt="JS.ORG Logo" class="lozad"> </a>| Hosted with <i class="far fa-heart"></i> by <a href="https://pages.github.com/" target="_blank">Github</a></div></div></div></footer></div><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha256-WqU1JavFxSAMcLP2WIOI+GB2zWmShMI82mTpLDcqFUg=" crossorigin="anonymous"></script><script async src="/assets/js/mediumish.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js" integrity="sha256-hstwhDmGVwZjIwt6SlTG6sQBREWrWTBjVTik/JLlb1Y=" crossorigin="anonymous"></script><script>// lazy loads images
        const lazyloadObserver = lozad()
        lazyloadObserver.observe();</script><script async src="/assets/js/ie10-viewport-bug-workaround.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-74370272-6"></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-74370272-6');</script></body></html>