<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="icon" href="/assets/images/logo.png"><title>How to set up Java microservices with Istio service mesh on Kubernetes | Technorage</title><meta name="generator" content="Jekyll v4.1.1"><meta property="og:title" content="How to set up Java microservices with Istio service mesh on Kubernetes"><meta name="author" content="deepu"><meta property="og:locale" content="en_US"><meta name="description" content="How to set up JHipster microservices with Istio service mesh on Kubernetes and deploy to AKS or GKE"><meta property="og:description" content="How to set up JHipster microservices with Istio service mesh on Kubernetes and deploy to AKS or GKE"><link rel="canonical" href="https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes"><meta property="og:url" content="https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes"><meta property="og:site_name" content="Technorage"><meta property="og:type" content="article"><meta property="article:published_time" content="2019-07-23T00:00:00+02:00"><meta name="twitter:card" content="summary"><meta property="twitter:title" content="How to set up Java microservices with Istio service mesh on Kubernetes"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"deepu"},"dateModified":"2019-07-23T00:00:00+02:00","datePublished":"2019-07-23T00:00:00+02:00","description":"How to set up JHipster microservices with Istio service mesh on Kubernetes and deploy to AKS or GKE","headline":"How to set up Java microservices with Istio service mesh on Kubernetes","mainEntityOfPage":{"@type":"WebPage","@id":"https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://deepu.tech/assets/images/logo.png"},"name":"deepu"},"url":"https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes"}</script><link rel="canonical" href="https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes"><meta property="og:url" content=""><meta name="monetization" content="$ilp.uphold.com/Aw7eGpxKNyK7"><meta name="twitter:site" content="@deepu105"><meta name="twitter:creator" content="@deepu105"><meta name="twitter:title" content="How to set up Java microservices with Istio service mesh on Kubernetes"><meta name="twitter:description" content="How to set up JHipster microservices with Istio service mesh on Kubernetes and deploy to AKS or GKE"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://thepracticaldev.s3.amazonaws.com/i/lb5p4gnuof61zxyi6byx.jpg"><link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha256-L/W5Wfqfa0sdBNIKN9cG6QA5F2qx4qICmU2VgLruv9Y=" crossorigin="anonymous" as="style" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha256-L/W5Wfqfa0sdBNIKN9cG6QA5F2qx4qICmU2VgLruv9Y=" crossorigin="anonymous"></noscript><link href="/assets/css/main.css" rel="stylesheet"></head><body class="layout-post"><noscript id="deferred-styles"><link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css" crossorigin="anonymous"></noscript><nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down pr-md-0 pl-md-0"><div class="container d-flex align-items-center"><a class="navbar-brand" href="/"><h2 class="sitetitle">Technorage</h2><small class="sitetitlesub">Where I rant about technology and stuff! </small></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarMediumish"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="/">About</a></li><li class="nav-item active"><a class="nav-link" href="/blogs/"><i class="fas fa-blog"></i> Blog</a></li><li class="nav-item"><a class="nav-link" href="/books"><i class="fas fa-book"></i> Books</a></li><li class="nav-item"><a class="nav-link" href="/appearances"><i class="fas fa-chalkboard-teacher"></i> Events</a></li><style>.lunrsearchresult .title{color:#d9230f}.lunrsearchresult .url{color:silver}.lunrsearchresult a{display:block;color:#777}.lunrsearchresult a:focus,.lunrsearchresult a:hover{text-decoration:none}.lunrsearchresult a:hover .title{text-decoration:underline}</style><form class="bd-search" onsubmit='return lunr_search(document.getElementById("lunrsearch").value)'><input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."></form><div id="lunrsearchresults"><ul></ul></div></ul></div></div></nav><div class="site-content"><div class="container"><div class="main-content"><div class="container mt-5"><div class="row"><div class="col-lg-2 pl-0"><div class="sticky-top sticky-top-offset"><div class="popover-wrapper d-none d-lg-block"><a href="#"><h2 class="popover-title"><i class="fas fa-stream fa-lg"></i> TOC</h2></a><div class="popover-content"><div class="toc lead"><h3 class="font-weight-bold">Summary</h3><ul><li><a href="#istio">Istio</a></li><li><a href="#preparing-the-kubernetes-cluster">Preparing the Kubernetes cluster</a><ul><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#create-a-cluster-on-azure-kubernetes-serviceaks">Create a cluster on Azure Kubernetes Service(AKS)</a></li><li><a href="#create-a-cluster-on-google-kubernetes-enginegke">Create a cluster on Google Kubernetes Engine(GKE)</a></li></ul></li><li><a href="#install-and-setup-istio">Install and setup Istio</a></li><li><a href="#creating-the-microservice-application-stack">Creating the microservice application stack</a><ul><li><a href="#architecture">Architecture</a></li><li><a href="#application-jdl">Application JDL</a></li><li><a href="#deployment-jdl">Deployment JDL</a></li><li><a href="#generate-the-applications-and-deployment-manifests">Generate the applications and deployment manifests</a></li><li><a href="#interim-issues-with-generated-code">Interim issues with generated code</a></li></ul></li><li><a href="#deploy-to-kubernetes-cluster-using-kubectl">Deploy to Kubernetes cluster using Kubectl</a></li><li><a href="#deployed-applications">Deployed applications</a><ul><li><a href="#application-gateway">Application gateway</a></li><li><a href="#monitoring">Monitoring</a></li><li><a href="#observability">Observability</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#devoxx-2018">Devoxx 2018</a></li></ul></div></div></div><div class="share"><p>Share</p><ul><li class="ml-1 mr-1"><div class="mast-share mast-share-sm"><input type="checkbox" class="mast-check-toggle"><div class="mast-instance"><span>Instance: </span><input type="textbox" name="mast-instance-input" placeholder="mastodon.social"> <button class="mast-share-button">Share</button></div><label title="Mastodon" class="mast-top mast-check-label"><i class="fab fa-mastodon"></i></label></div><script>Array.prototype.forEach || (Array.prototype.forEach = function (r) { var o, t; if (null == this) throw new TypeError("this is null or not defined"); var n = Object(this), e = n.length >>> 0; if ("function" != typeof r) throw new TypeError(r + " is not a function"); for (arguments.length > 1 && (o = arguments[1]), t = 0; t < e;) { var i; t in n && (i = n[t], r.call(o, i, t, n)), t++ } }); document.addEventListener("DOMContentLoaded", function () { document.querySelectorAll(".mast-share").forEach(function (e, t) { e.querySelector(".mast-check-toggle").id = "mast-check-toggle-" + t, e.querySelector(".mast-check-label").htmlFor = "mast-check-toggle-" + t, e.querySelector(".mast-share-button").addEventListener("click", function (t) { var a = new RegExp("^(?:(?:https?|ftp)://)?(?:\\S+(?::\\S*)?@|\\d{1,3}(?:\\.\\d{1,3}){3}|(?:(?:[a-z\\d\\u00a1-\\uffff]+-?)*[a-z\\d\\u00a1-\\uffff]+)(?:\\.(?:[a-z\\d\\u00a1-\\uffff]+-?)*[a-z\\d\\u00a1-\\uffff]+)*(?:\\.[a-z\\u00a1-\\uffff]{2,6}))(?::\\d+)?(?:[^\\s]*)?$", "i"), n = e.querySelector('input[name="mast-instance-input"]'); if (a.test(n.value)) { var o = `http://${n.value.replace(/(^\w+:|^)\/\//, "")}/share?text=${encodeURIComponent(document.title)} ${encodeURIComponent(location.href)}`; window.open(o, "new", "toolbar=no,location=no,status=yes,resizable=yes,scrollbars=yes,height=600,width=400") } else n.classList.add("invalid"), setTimeout(function () { n.classList.remove("invalid") }, 300) }), e.addEventListener("mouseleave", function (t) { e.querySelector(".mast-check-toggle").checked = !1 }) }) });</script></li><li class="ml-1 mr-1"><a target="_blank" href="https://twitter.com/intent/tweet?text=How to set up Java microservices with Istio service mesh on Kubernetes by @deepu105 &url=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/" onclick='return window.open(this.href,"twitter-share","width=550,height=235"),!1' title="Twitter"><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/" onclick='return window.open(this.href,"linkedin-share","width=550,height=435"),!1' title="Linkedin"><i class="fab fa-linkedin-in"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://news.ycombinator.com/submitlink?u=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/&t=How to set up Java microservices with Istio service mesh on Kubernetes" onclick='return window.open(this.href,"hackernews-share","width=550,height=435"),!1' title="Hacker News"><i class="fab fa-hacker-news-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.reddit.com/submit?url=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/&title=How to set up Java microservices with Istio service mesh on Kubernetes" onclick='return window.open(this.href,"reddit-share","width=550,height=435"),!1' title="Reddit"><i class="fab fa-reddit-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://facebook.com/sharer.php?u=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/" onclick='return window.open(this.href,"facebook-share","width=550,height=435"),!1' title="Facebook"><i class="fab fa-facebook-f"></i></a></li></ul></div><div class="ad-vertical-md"><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3I&placement=deeputech" id="_carbonads_js"></script></div></div></div><div class="col-lg-9 flex-first flex-lg-unordered"><div class="mainheading"><h1 class="posttitle">How to set up Java microservices with Istio service mesh on Kubernetes</h1><img data-src="https://thepracticaldev.s3.amazonaws.com/i/lb5p4gnuof61zxyi6byx.jpg" alt="How to set up Java microservices with Istio service mesh on Kubernetes" class="featured-image img-fluid lozad" src="/assets/images/placeholder.jpg"><div class="row post-top-meta"><div class="col-12 text-center text-md-left mb-4 mb-md-0"><img class="author-thumb lozad" src="/assets/images/placeholder.jpg" data-src="https://www.gravatar.com/avatar/7f408bc67dc9ae3b288ee92d16d3c4c2?s=250&d=mm&r=x" alt="Deepu K Sasidharan"> <a target="_blank" class="link-dark" href="https://www.deepu.tech">Deepu K Sasidharan</a><a target="_blank" href="https://mastodon.social/@deepu105" class="btn follow"><i class="fab fa-mastodon"></i> Follow</a><span class="separator d-none d-md-inline-block">| </span><span class="author-description"><small><time class="post-date" datetime="2019-07-23">23 Jul 2019</time> </small><span class="separator d-inline-block">| </span><small>12 mins read </small><span class="separator d-inline-block d-lg-none">| </span><span class="d-inline-block d-lg-none"><div class="share" style="margin-top:0"><ul><li class="ml-1 mr-1"><div class="mast-share mast-share-sm"><input type="checkbox" class="mast-check-toggle"><div class="mast-instance"><span>Instance: </span><input type="textbox" name="mast-instance-input" placeholder="mastodon.social"> <button class="mast-share-button">Share</button></div><label title="Mastodon" class="mast-top mast-check-label"><i class="fab fa-mastodon"></i></label></div><script>Array.prototype.forEach || (Array.prototype.forEach = function (r) { var o, t; if (null == this) throw new TypeError("this is null or not defined"); var n = Object(this), e = n.length >>> 0; if ("function" != typeof r) throw new TypeError(r + " is not a function"); for (arguments.length > 1 && (o = arguments[1]), t = 0; t < e;) { var i; t in n && (i = n[t], r.call(o, i, t, n)), t++ } }); document.addEventListener("DOMContentLoaded", function () { document.querySelectorAll(".mast-share").forEach(function (e, t) { e.querySelector(".mast-check-toggle").id = "mast-check-toggle-" + t, e.querySelector(".mast-check-label").htmlFor = "mast-check-toggle-" + t, e.querySelector(".mast-share-button").addEventListener("click", function (t) { var a = new RegExp("^(?:(?:https?|ftp)://)?(?:\\S+(?::\\S*)?@|\\d{1,3}(?:\\.\\d{1,3}){3}|(?:(?:[a-z\\d\\u00a1-\\uffff]+-?)*[a-z\\d\\u00a1-\\uffff]+)(?:\\.(?:[a-z\\d\\u00a1-\\uffff]+-?)*[a-z\\d\\u00a1-\\uffff]+)*(?:\\.[a-z\\u00a1-\\uffff]{2,6}))(?::\\d+)?(?:[^\\s]*)?$", "i"), n = e.querySelector('input[name="mast-instance-input"]'); if (a.test(n.value)) { var o = `http://${n.value.replace(/(^\w+:|^)\/\//, "")}/share?text=${encodeURIComponent(document.title)} ${encodeURIComponent(location.href)}`; window.open(o, "new", "toolbar=no,location=no,status=yes,resizable=yes,scrollbars=yes,height=600,width=400") } else n.classList.add("invalid"), setTimeout(function () { n.classList.remove("invalid") }, 300) }), e.addEventListener("mouseleave", function (t) { e.querySelector(".mast-check-toggle").checked = !1 }) }) });</script></li><li class="ml-1 mr-1"><a target="_blank" href="https://twitter.com/intent/tweet?text=How to set up Java microservices with Istio service mesh on Kubernetes by @deepu105 &url=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/" onclick='return window.open(this.href,"twitter-share","width=550,height=235"),!1' title="Twitter"><i class="fab fa-twitter"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.linkedin.com/shareArticle?mini=true&url=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/" onclick='return window.open(this.href,"linkedin-share","width=550,height=435"),!1' title="Linkedin"><i class="fab fa-linkedin-in"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://news.ycombinator.com/submitlink?u=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/&t=How to set up Java microservices with Istio service mesh on Kubernetes" onclick='return window.open(this.href,"hackernews-share","width=550,height=435"),!1' title="Hacker News"><i class="fab fa-hacker-news-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://www.reddit.com/submit?url=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/&title=How to set up Java microservices with Istio service mesh on Kubernetes" onclick='return window.open(this.href,"reddit-share","width=550,height=435"),!1' title="Reddit"><i class="fab fa-reddit-square"></i></a></li><li class="ml-1 mr-1"><a target="_blank" href="https://facebook.com/sharer.php?u=https://deepu.tech/jhipster-microservices-with-istio-service-mesh-on-kubernetes/" onclick='return window.open(this.href,"facebook-share","width=550,height=435"),!1' title="Facebook"><i class="fab fa-facebook-f"></i></a></li></ul></div></span></span></div></div></div><div class="panel"><p><strong>This is part of my "Microservices with JHipster" series</strong></p><ol><li><a href="/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes/">Create full Microservice stack using JHipster Domain Language under 30 minutes</a></li><li><a href="/deploying-jhipster-microservices-on-azure-kubernetes-service-aks/">Deploying JHipster Microservices on Azure Kubernetes Service (AKS)</a></li><li><strong>How to set up Java microservices with Istio service mesh on Kubernetes</strong></li></ol></div><div class="article-post"><p>Originally published at <a href="https://medium.com/free-code-camp/jhipster-microservices-with-istio-service-mesh-on-kubernetes-a7d0158ba9a3">Medium</a> on 17-Nov-2018. This post has been updated on Jan-2020 to work with the latest version of JHipster(7.0.0-beta.1) and Istio(1.8.2).</p><hr><p>Istio is the coolest kid on the DevOps and Cloud block now. For those of you who aren’t following close enough — <a href="https://istio.io/docs/concepts/what-is-istio/">Istio</a> is a service mesh for distributed application architectures, especially the ones that you run on the cloud with Kubernetes. Istio plays extremely nice with Kubernetes, so nice that you might think that it’s part of the Kubernetes platform. Platforms like Google Cloud even provide it out of the box when you use the Google Kubernetes Engine.</p><p>If you are still wondering, what the heck is a service mesh or Istio? then let’s have an overview of Istio.</p><h2 id="istio">Istio</h2><p>Istio provides the following functionality in a distributed application architecture:</p><ul><li><p>Service discovery — Traditionally provided by platforms like <a href="https://github.com/Netflix/eureka/wiki">Netflix Eureka </a>or <a href="https://www.consul.io/">Consul</a>.</p></li><li><p>Automatic load balancing — You might have used <a href="https://github.com/Netflix/zuul/wiki">Netflix Zuul</a> for this.</p></li><li><p>Routing, circuit breaking, retries, fail-overs, fault injection — Think of <a href="https://github.com/Netflix/ribbon/wiki">Netflix Ribbon</a>, <a href="https://github.com/Netflix/Hystrix">Hytrix</a> and so on.</p></li><li><p>Policy enforcement for access control, rate limiting, A/B testing, traffic splits, and quotas — Again you might have used Zuul to do some of these.</p></li><li><p>Metrics, logs, and traces — Think of <a href="https://www.elastic.co/elk-stack">ELK</a> or <a href="https://cloud.google.com/stackdriver/">Stack driver</a></p></li><li><p>Secure service-to-service communication</p></li></ul><p>Below is the architecture of Istio.</p><p><img src="https://cdn-images-1.medium.com/max/2500/1*_STCerKXb4L3Hutyn4P5Gw.png" alt="Istio architecture"><em>Istio architecture</em></p><p>It can be classified into 2 distinct planes.</p><p><strong>Data plane</strong>: Is made of <a href="https://www.envoyproxy.io/">Envoy</a> proxies deployed as sidecars to the application containers. They control all the incoming and outgoing traffic to the container.</p><p><strong>Control plane</strong>: It uses Pilot to manages and configure the proxies to route traffic. It also configures Mixer to enforce policies and to collect telemetry. It also has other components like Citadel, to manage security, and Galley, to manage configurations.</p><p>You can also configure <a href="https://grafana.com/">Grafana</a>, <a href="https://prometheus.io/">Prometheus</a>, <a href="https://www.jaegertracing.io/">Jaeger</a>/<a href="https://zipkin.io/">Zipkin</a>, and <a href="https://www.kiali.io/">Kiali</a> for Monitoring and Observability as they work well with Istio. You can use this or use your existing monitoring stack as well if you wish to do so. If you use the demo profile that comes with Istio, it preconfigures dashboards and configurations for Grafana, Kiali, and so on.</p><p>I hope this provides an overview of Istio, now let’s focus on the goal of this article.</p><h2 id="preparing-the-kubernetes-cluster">Preparing the Kubernetes cluster</h2><p>First, let us prepare a Kubernetes cluster to deploy Istio and our application containers. Follow the instructions for any one of the platforms you prefer.</p><h3 id="prerequisites">Prerequisites</h3><p>We will be using <a href="https://istio.io/latest/docs/reference/commands/istioctl/">istioctl</a> to install Istio on the Kubernetes cluster and <a href="https://kubernetes.io/docs/reference/kubectl/kubectl/">kubectl</a> for deploying the applications.</p><p><a href="https://kubernetes.io/docs/reference/kubectl/kubectl/"><strong>kubectl</strong></a>: The command-line tool to interact with Kubernetes. <a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">Install</a> and configure it.</p><h3 id="create-a-cluster-on-azure-kubernetes-serviceaks">Create a cluster on Azure Kubernetes Service(AKS)</h3><p>If you are going to use Azure, then install <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest"><strong>Azure CLI</strong></a> to interact with Azure. Install and login with your Azure account (you can create a <a href="https://azure.microsoft.com/en-us/free/">free account</a> if you don’t have one already). If not skip this section.</p><p>First, let us create a resource group. You can use any region you like here instead of East-US.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>az group create <span class="nt">--name</span> eCommerceCluster <span class="nt">--location</span> eastus
</pre></td></tr></tbody></table></code></pre></div></div><p>Create the Kubernetes cluster:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>az aks create <span class="se">\</span>
  <span class="nt">--resource-group</span> eCommerceCluster <span class="se">\</span>
  <span class="nt">--name</span> eCommerceCluster <span class="se">\</span>
  <span class="nt">--node-count</span> 4 <span class="se">\</span>
  <span class="nt">--kubernetes-version</span> 1.15 <span class="se">\</span>
  <span class="nt">--enable-addons</span> monitoring <span class="se">\</span>
  <span class="nt">--generate-ssh-keys</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">node-count</code> flag is important as the setup requires at least four nodes with the default CPU to run everything. You can try to use a higher <code class="language-plaintext highlighter-rouge">kubernetes-version</code> if it is supported, else stick to 1.15</p><p>The cluster creation could take a while so sit back and relax. 🍹</p><p>Once the cluster is created, fetch its credentials to be used from kubectl by running the below command. It automatically injects the credentials to your kubectl configuration under <strong><em>~/.kube/config</em></strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>az aks get-credentials <span class="se">\</span>
  <span class="nt">--resource-group</span> eCommerceCluster <span class="se">\</span>
  <span class="nt">--name</span> eCommerceCluster
</pre></td></tr></tbody></table></code></pre></div></div><p>You can view the created cluster in the Azure portal:</p><p><img src="https://cdn-images-1.medium.com/max/3284/1*yfLnHHc_N7VCkEY9vjNciQ.png" alt="Kubernetes cluster in AKS"><em>Kubernetes cluster in AKS</em></p><p>Run <code class="language-plaintext highlighter-rouge">kubectl get nodes</code> to see it in the command line and to verify that kubectl can connect to your cluster.</p><p><img src="https://cdn-images-1.medium.com/max/2000/1*k8xsRqQsvnquUhGPAh9TsA.png" alt="Cluster Nodes"><em>Cluster Nodes</em></p><p>Proceed to the <strong><a href="#install-and-setup-istio">Install and setup Istio</a></strong> section.</p><h3 id="create-a-cluster-on-google-kubernetes-enginegke">Create a cluster on Google Kubernetes Engine(GKE)</h3><p>If you are going to use Google Cloud Platform(GCP) then install <a href="https://cloud.google.com/sdk/docs/"><strong>Gcloud CLI</strong></a> to interact with GCP. Install and login with your GCP account (you can create a <a href="https://console.cloud.google.com/freetrial">free account</a> if you don’t have one already).</p><p>You can set a region and zone using the below commands or you can pass the zone option while executing each command.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gcloud config <span class="nb">set </span>compute/region europe-west1
<span class="nv">$ </span>gcloud config <span class="nb">set </span>compute/zone europe-west1-b
</pre></td></tr></tbody></table></code></pre></div></div><p>First, we need a GCP project, you can either use an existing project that you have or create a new one using GCloud CLI with the below command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gcloud projects create jhipster-demo-deepu
</pre></td></tr></tbody></table></code></pre></div></div><p>Set the project you want to use as the default project and enable the container API. You also need to enable billing for the project via the <a href="https://console.cloud.google.com/">Google Cloud Console</a></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gcloud config <span class="nb">set </span>project jhipster-demo-deepu
<span class="nv">$ </span>gcloud services <span class="nb">enable </span>container.googleapis.com
</pre></td></tr></tbody></table></code></pre></div></div><p>Now let us create a cluster for our application with the below command:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gcloud container clusters create hello-hipster <span class="se">\</span>
    <span class="nt">--cluster-version</span> latest <span class="se">\</span>
    <span class="nt">--num-nodes</span> 4 <span class="se">\</span>
    <span class="nt">--machine-type</span> n1-standard-2
</pre></td></tr></tbody></table></code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">num-nodes</code> and <code class="language-plaintext highlighter-rouge">machine-type</code> flags are important as the setup requires at least four nodes with a bigger CPU to run everything. You can try to use the latest <code class="language-plaintext highlighter-rouge">cluster-version</code> if it is supported, else stick to 1.17.</p><p>The cluster creation could take a while so sit back and relax. 🍹</p><p>Once the cluster is created, fetch its credentials to be used from kubectl by running the below command. It automatically injects the credentials to your kubectl configuration under <strong><em>~/.kube/config</em></strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gcloud container clusters get-credentials hello-hipster
</pre></td></tr></tbody></table></code></pre></div></div><p>You can view the created cluster in the GCP GUI.</p><p><img src="https://cdn-images-1.medium.com/max/2000/1*ZxNbIG4vqWJymTLweJpPyQ.png" alt="Kubernetes cluster on GKE"><em>Kubernetes cluster on GKE</em></p><p>Run <code class="language-plaintext highlighter-rouge">kubectl get nodes</code> to see it in the command line and to verify that kubectl can connect to your cluster.</p><p><img src="https://cdn-images-1.medium.com/max/2000/1*F5Qcd_GS_GSuA1PsJE7gvA.png" alt="Cluster Nodes"><em>Cluster Nodes</em></p><h2 id="install-and-setup-istio">Install and setup Istio</h2><p>Install Istio on your local machine by following these steps:</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd</span> ~/

<span class="nv">$ </span><span class="nb">export </span><span class="nv">ISTIO_VERSION</span><span class="o">=</span>1.8.2

<span class="nv">$ </span>curl <span class="nt">-L</span> https://istio.io/downloadIstio | sh -

<span class="nv">$ </span><span class="nb">ln</span> <span class="nt">-sf</span> istio-<span class="nv">$ISTIO_VERSION</span> istio

<span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>~/istio/bin:<span class="nv">$PATH</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Now let us install Istio on our Kubernetes cluster using the provided charts from Istio.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># Install the Istio CRDs and components from the Demo profile</span>
<span class="nv">$ </span>istioctl <span class="nb">install</span> <span class="nt">--set</span> <span class="nv">profile</span><span class="o">=</span>demo <span class="nt">-y</span>

<span class="c"># Install Addons like Grfana, Prometheus, Kiali and Zipkin</span>
<span class="nv">$ </span><span class="nb">cd</span> ~/istio
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> samples/addons/grafana.yaml
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> samples/addons/prometheus.yaml
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> samples/addons/kiali.yaml
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> samples/addons/extras/zipkin.yaml
</pre></td></tr></tbody></table></code></pre></div></div><p>Wait for the pods to run, these will be deployed to the <code class="language-plaintext highlighter-rouge">istio-system</code> namespace.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>watch kubectl get pods <span class="nt">-n</span> istio-system
</pre></td></tr></tbody></table></code></pre></div></div><p>Once the pods are in running status, exit the watch loop and run the below to get the Ingress gateway service details. This is the only service that is exposed to an external IP.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>kubectl get svc istio-ingressgateway <span class="nt">-n</span> istio-system

NAME                   TYPE           CLUSTER-IP     EXTERNAL-IP
istio-ingressgateway   LoadBalancer   10.27.249.83   35.195.81.130
</pre></td></tr></tbody></table></code></pre></div></div><p>If the <code class="language-plaintext highlighter-rouge">istio-ingressgateway</code> shows external IP as<pending>, wait a few minutes until an IP address has been assigned.</pending></p><p>The external IP is very important here, let us save this to an environment variable so that we can use it in further commands.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">export</span> <span class="se">\</span>
  <span class="nv">INGRESS_IP</span><span class="o">=</span><span class="si">$(</span>kubectl <span class="nt">-n</span> istio-system get svc <span class="se">\</span>
  istio-ingressgateway <span class="se">\</span>
  <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.status.loadBalancer.ingress[0].ip}'</span><span class="si">)</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>There is an additional step that you need to do here for Istio. The automatically created firewall rule does not open port 15017. This Pilot discovery validation webhook needs this so we need to add that. First, fetch the firewall rules added by Istio for the project by running the below command. If there is more than one, just pick anyone. If you can’t find any run the command without filter and look for a rule with Istio in the description.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>gcloud compute firewall-rules list <span class="nt">--filter</span><span class="o">=</span><span class="s2">"name~k8s-fw-[0-9a-z]*"</span> <span class="nt">--format</span><span class="o">=</span>json
</pre></td></tr></tbody></table></code></pre></div></div><p>Now update this rule to add the needed port using the command below, replace the name with the actual name of the rule you fetched above, and add all the original ports to the list</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>gcloud compute firewall-rules update &lt;firewall rule name&gt; --allow tcp:15017,tcp:80,tcp:443,&lt;append all other protocol:port comma separated&gt;
</pre></td></tr></tbody></table></code></pre></div></div><p>Now our Kubernetes cluster is ready for Istio. 🎉</p><p><em>For advanced Istio setup options refer to <a href="https://istio.io/docs/setup/kubernetes/">https://istio.io/docs/setup/kubernetes/</a></em></p><h2 id="creating-the-microservice-application-stack">Creating the microservice application stack</h2><p>In one of my <a href="https://deepu.tech/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes">previous posts</a>, I showcased how to create a full-stack microservice architecture using <strong>JHipster</strong> and <strong>JDL</strong>. You can read the post <a href="https://deepu.tech/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes">here</a> if you want to learn more details about it. For this exercise, we will use the same application but we will not use the Eureka service discovery option we used earlier. Also, note that the store application is further split into Gateway and Product applications.</p><h3 id="architecture">Architecture</h3><p>Here is the architecture of the microservice that we are going to create and deploy today.</p><p><img src="https://cdn-images-1.medium.com/max/2162/1*UmNJ-Ue362-OltPOxt-OFQ.png" alt="Microservice architecture with Istio"><em>Microservice architecture with Istio</em></p><p>It has a gateway application and three microservice applications. Each of them has its own database. You can see that each application has an Envoy proxy attached to the pod as a sidecar. Istio control plane components are also deployed to the same cluster along with Prometheus, Grafana, and Jaeger.</p><p>The Ingress gateway from Istio is the only entry point for traffic and it routes traffic to all microservices accordingly. Telemetry is collected from all the containers running in the cluster, including the applications, databases, and Istio components.</p><p>Compared to the architecture of the original application <a href="https://deepu.tech/create-full-microservice-stack-using-j-hipster-domain-language-under-30-minutes">here</a>, you can clearly see that we replaced the JHipster registry and Netflix OSS components with Istio. The ELK monitoring stack is replaced with Prometheus, Grafana and Jaeger configured by Istio. Here is the original architecture diagram without Istio for a quick visual comparison.</p><p><img src="https://cdn-images-1.medium.com/max/2162/1*H-6_dz1-aYXQ-fzWEuJcRw.png" alt="Microservice architecture with Netflix OSS"><em>Microservice architecture with Netflix OSS</em></p><h3 id="application-jdl">Application JDL</h3><p>Let’s take a look at the modified JDL declaration. You can see that we have declared <code class="language-plaintext highlighter-rouge">serviceDiscoveryType no</code> here since we will be using Istio for that.</p><noscript><pre>400: Invalid request</pre></noscript><script src="https://gist.github.com/8e568eb7b5b5e3c00af0fdf3d2cf71ba.js"></script><h3 id="deployment-jdl">Deployment JDL</h3><p>JHipster version 5.7.0 introduced support for deployment declaration straight in the JDL</p><div class="jekyll-twitter-plugin"><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Towards the future of <a href="https://twitter.com/hashtag/JHipster?src=hash&amp;ref_src=twsrc%5Etfw">#JHipster</a>, <a href="https://twitter.com/hashtag/ScaffoldingAsCode?src=hash&amp;ref_src=twsrc%5Etfw">#ScaffoldingAsCode</a><br>Check this out. Soon you will be able to define apps, entities and deployment options with a single JDL file and generate everything with a single command. Hopefully, we can demo this for <a href="https://twitter.com/Devoxx?ref_src=twsrc%5Etfw">@Devoxx</a> <a href="https://t.co/u28cwaymfc">https://t.co/u28cwaymfc</a></p>&mdash; Deepu K Sasidharan (@deepu105) <a href="https://twitter.com/deepu105/status/1056588722769195018?ref_src=twsrc%5Etfw">October 28, 2018</a></blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><p>We have the below in our JDL which declares our Kubernetes deployment:</p><div class="language-groovy highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="n">deployment</span> <span class="o">{</span>
  <span class="n">deploymentType</span> <span class="n">kubernetes</span>
  <span class="n">appsFolders</span> <span class="o">[</span><span class="n">store</span><span class="o">,</span> <span class="n">invoice</span><span class="o">,</span> <span class="n">notification</span><span class="o">,</span> <span class="n">product</span><span class="o">]</span>
  <span class="n">dockerRepositoryName</span> <span class="s2">"deepu105"</span>
  <span class="n">serviceDiscoveryType</span> <span class="n">no</span>
  <span class="n">istio</span> <span class="kc">true</span>
  <span class="n">kubernetesServiceType</span> <span class="n">Ingress</span>
  <span class="n">kubernetesNamespace</span> <span class="n">jhipster</span>
  <span class="n">ingressDomain</span> <span class="s2">"35.195.81.130.nip.io"</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>The <code class="language-plaintext highlighter-rouge">serviceDiscoveryType</code> is disabled and we have enabled <code class="language-plaintext highlighter-rouge">Istio</code> support — the Envoy sidecars are injected automatically for the selected applications. Istio routes are also generated for the applications automatically.</p><p>The <code class="language-plaintext highlighter-rouge">kubernetesServiceType</code> is set as <code class="language-plaintext highlighter-rouge">Ingress</code>, which is very important as Istio can only work with an Ingress controller service type. For Ingress, we need to set the domain DNS and this is where the Istio ingress gateway IP is needed. Now we need a DNS for our IP. For real use-cases, you should map a DNS for the IP, but for testing and demo purposes we can use a wildcard DNS service like <a href="http://nip.io"><strong>nip.io</strong></a> to resolve our IP. Just append nip.io to our IP and use that as the <code class="language-plaintext highlighter-rouge">ingressDomain</code>.</p><p><strong>Note:</strong> I was switching between multiple clusters while writing this article as I didn’t want to keep them running and hence my istio-ingressgateway IP might be different between samples and screenshots. Use the IP based on your own setup if you are running these samples.</p><h3 id="generate-the-applications-and-deployment-manifests">Generate the applications and deployment manifests</h3><p>Now that our JDL is ready, let us scaffold our applications and Kubernetes manifests. Create a new directory and save the above JDL in the directory. Let us name it <strong><em>app-istio.jdl</em></strong> and then run the jdl command.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">mkdir </span>istio-demo <span class="o">&amp;&amp;</span> <span class="nb">cd </span>istio-demo
<span class="nv">$ </span>jhipster jdl app-istio.jdl <span class="nt">--fork</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>This will generate all the applications and install the required NPM dependencies in each of them. Once the applications are generated the deployment manifests will be generated and some useful instruction will be printed to the console.</p><p><img src="https://cdn-images-1.medium.com/max/2776/0*ROg2XrRkHVHA4Xib" alt="Generation output"><em>Generation output</em></p><p>Open the generated code in your favorite IDE/Editor and explore the code.</p><h3 id="interim-issues-with-generated-code">Interim issues with generated code</h3><p>There was a <a href="https://github.com/jhipster/generator-jhipster/issues/10135">bug</a> in the latest JHipster version which creates some incorrect URLs for Istio, it has been fixed as of JHipster version 6.3.0 <a href="https://github.com/jhipster/generator-jhipster/pull/10138">here is the PR</a> for the issue.</p><h2 id="deploy-to-kubernetes-cluster-using-kubectl">Deploy to Kubernetes cluster using Kubectl</h2><p>Now let us build and deploy our applications. Run the <code class="language-plaintext highlighter-rouge">./gradlew bootJar -Pprod jibDockerBuild</code> command in the store, product, invoice, and notification folders to build the docker images. Once the images are built, push them to your docker repo with these commands. Note to change the Docker hub id from <code class="language-plaintext highlighter-rouge">deepu105</code> to your id.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>docker image tag store deepu105/store
<span class="nv">$ </span>docker push deepu105/store

<span class="nv">$ </span>docker image tag invoice deepu105/invoice
<span class="nv">$ </span>docker push deepu105/invoice

<span class="nv">$ </span>docker image tag notification deepu105/notification
<span class="nv">$ </span>docker push deepu105/notification

<span class="nv">$ </span>docker image tag product deepu105/product
<span class="nv">$ </span>docker push deepu105/product
</pre></td></tr></tbody></table></code></pre></div></div><p>Once the images are pushed, navigate into the generated Kubernetes directory and run the provided startup script. (If you are on windows you can run the steps in <strong><em>kubectl-apply.sh</em></strong> manually one by one.)</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd </span>kubernetes
<span class="nv">$ </span>./kubectl-apply.sh <span class="nt">-f</span>
</pre></td></tr></tbody></table></code></pre></div></div><p>Run <code class="language-plaintext highlighter-rouge">watch kubectl get pods -n jhipster</code> to monitor the status.</p><h2 id="deployed-applications">Deployed applications</h2><p>Once all the pods are in running status we can explore the deployed applications</p><h3 id="application-gateway">Application gateway</h3><p>The store gateway application is the entry point for our microservices. Get the URL for the store app by running <code class="language-plaintext highlighter-rouge">echo store.jhipster.$INGRESS_IP.nip.io</code>, we already stored the <code class="language-plaintext highlighter-rouge">INGRESS_IP</code> to environment variables while creating the Istio setup. The URLs are also printed on the console by the <code class="language-plaintext highlighter-rouge">kubectl-apply.sh</code> script. Visit the URL in your favorite browser and explore the application. Try creating some entities for the microservices:</p><p><img src="https://thepracticaldev.s3.amazonaws.com/i/cyd7foljtf7qkm6amgjj.png" alt="Store gateway application"><em>Store gateway application</em></p><h3 id="monitoring">Monitoring</h3><p>Istio setup includes Grafana and Prometheus configured to collect and show metrics from our containers. Let’s take a look.</p><p>Let us look at Grafana by visiting the provided URL. Get it by running <code class="language-plaintext highlighter-rouge">istioctl dashboard grafana</code>:</p><p><img src="https://thepracticaldev.s3.amazonaws.com/i/x7ck1zidvch5m75tqimp.png" alt="Grafana dashboard for the Store application"><em>Grafana dashboard for the Store application</em></p><p>Grafana uses the metrics scraped by Prometheus. You can view the Prometheus instance by running <code class="language-plaintext highlighter-rouge">istioctl dashboard prometheus</code></p><p><img src="https://cdn-images-1.medium.com/max/2554/0*W4obHNne_wQJfAuU" alt="Prometheus dashboard"><em>Prometheus dashboard</em></p><h3 id="observability">Observability</h3><p>Istio configures Zipkin for distributed tracing and Kiali for service observability. Let us take a look at them.</p><p>Get the Zipkin URL by running <code class="language-plaintext highlighter-rouge">istioctl dashboard zipkin</code>:</p><p><img src="https://i.imgur.com/9no999M.png" alt="Zipkin tracing dashboard"><em>Zipkin tracing dashboard</em></p><p>You can make some requests in the application and find them in the tracing dashboard by querying for the service. Click on any request to see tracing details.</p><p>Let us now look at Kiali. Get the URL by running <code class="language-plaintext highlighter-rouge">istioctl dashboard kiali</code>, use the credentials user: <em>admin</em>, password: <em>admin</em> to log in:</p><p><img src="https://thepracticaldev.s3.amazonaws.com/i/w9r30s3q4rmctjzejdwp.png" alt="Kiali service graph"><em>Kiali service graph</em></p><h2 id="conclusion">Conclusion</h2><p>Istio provides building blocks to build distributed microservices in a more Kubernetes-native way and takes the complexity and responsibility of maintaining those blocks away from you. This means you do not have to worry about maintaining the code or deployments for service discovery, tracing, and so on.</p><p>Istio documentation says</p><blockquote><p>Deploying a microservice-based application in an Istio service mesh allows one to externally control service monitoring and tracing, request (version) routing, resiliency testing, security and policy enforcement, etc., in a consistent way across the services, for the application as a whole.</p></blockquote><p>Werner Vogels (CTO of AWS) quoted at AWS Re:Invent</p><blockquote><p>“In the future, all the code you ever write will be business logic.”</p></blockquote><p>Istio Service mesh helps to make that reality closer. This lets you worry only about the applications that you are developing and with JHipster that future is truly here and you just need to worry about writing your business logic.</p><p>While this is great, it is not a silver bullet. Keep in mind that Istio is fairly new compared to other stable and battle-tested solutions like JHipster Registry (Eureka) or Consul and overall such architectures are suitable only for complex distributed applications.</p><p>Also, another thing to keep in mind is the resource requirements. The same microservices with JHipster Registry or Consul can be deployed to a 2 node cluster with 1 vCPU and 3.75 GB of memory per node in GCP while you need a 4 node cluster with 2 vCPUs and 7.5 GB of memory per node for Istio enabled deployments. The demo profile from Istio, we used, doesn’t apply any request limits for resources, and by adding and tuning those, the minimum requirement could be reduced. But still, I don’t think you can get it as low as that is needed for the JHipster registry option.</p><p>In a real-world use case, the advantages of not having to maintain the complex parts of your infra vs having to pay for more resources might be a decision that has to be taken based on your priorities and goals.</p><p>A huge shout out to <a href="https://twitter.com/saturnism">Ray Tsang</a> for helping me figure out an optimal cluster size for this application originally. Also a huge thank you from myself and the community to both Ray and <a href="https://twitter.com/humourmind">Srinivasa Vasu</a> for adding the Istio support to JHipster.</p><p>JHipster provides a great Kubernetes setup to start with which you can further tweak as per your needs and platform. The Istio support will <a href="https://github.com/jhipster/generator-jhipster/issues/7708">improve</a> further over time, but it’s still a great starting point especially to learn.</p><p>To learn more about JHipster and Full stack development, check out my book “<em>Full Stack Development with JHipster</em>” on <a href="https://www.amazon.com/Stack-Development-JHipster-Deepu-Sasidharan/dp/178847631X">Amazon</a> and <a href="https://www.packtpub.com/application-development/full-stack-development-jhipster">Packt</a>.</p><p>There is a great Istio tutorial from Ray Tsang <a href="https://docs.google.com/document/d/1Qo8o5C4UpGwMF7Mg02kLTaU4-xCSfJjLcnIFNveMEEA">here</a>.</p><hr><p>If you liked this article you might like my <a href="https://deepu.tech/books">book</a> as well. You can get it from <a href="https://www.packtpub.com/web-development/full-stack-development-with-jhipster-second-edition">Packt</a> and <a href="https://smile.amazon.com/Full-Stack-Development-JHipster-applications-microservices-ebook/dp/B083XLGV98">Amazon</a>.</p><p><img src="https://i.imgur.com/SSnzOvR.png" alt="book cover"></p><hr><h2 id="devoxx-2018">Devoxx 2018</h2><p>I did a talk at <a href="https://dvbe18.confinabox.com/talk/XCM-6395/JHipster_5_-_What's_new_and_noteworthy">Devoxx 2018</a> along with <a href="https://www.julien-dubois.com/">Julien Dubois</a> doing the same demo and promised that I’d write a detailed blog about it. This blog was originally based on that.</p><div class="jekyll-twitter-plugin"><blockquote class="twitter-tweet"><p lang="en" dir="ltr">Had a wonderful time at <a href="https://twitter.com/hashtag/devoxx2018?src=hash&amp;ref_src=twsrc%5Etfw">#devoxx2018</a>, sad that I had to leave early due to work commitments.<br>Had 3 talks and 1 of them with my friend and the real hipster <a href="https://twitter.com/juliendubois?ref_src=twsrc%5Etfw">@juliendubois</a>, all the talks were well received and I&#39;m grateful for all the positive feedback. Will write blogs about it soon</p>&mdash; Deepu K Sasidharan (@deepu105) <a href="https://twitter.com/deepu105/status/1063010906777497600?ref_src=twsrc%5Etfw">November 15, 2018</a></blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><p>You can watch this video to see JHipster + Istio in action.</p><p></p><div class="embed-video-container"><iframe class="lozad" width="710" height="399" data-src="https://www.youtube.com/embed/NPToZd0PxbI " allowfullscreen=""></iframe></div><p></p><p>Here are the slides on Speaker Deck.</p><p><script async="" class="speakerdeck-embed" data-id="d5813577c59043ca8753d9be01dc41ac" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script><noscript><a href="//speakerdeck.com/player/d5813577c59043ca8753d9be01dc41ac"><img alt="Speakerdeck" class="lozad" src="{{ site.baseurl }}/assets/images/placeholder.jpg" data-src="//speakerd.s3.amazonaws.com/presentations/d5813577c59043ca8753d9be01dc41ac/slide_0.jpg"></a></noscript></p><hr><p>If you like JHipster don’t forget to give it a star on <a href="https://github.com/jhipster/generator-jhipster">Github</a>.</p><p>If you like this article, please leave likes/comments. I hope to write more about Istio soon.</p><p>You can follow me on <a href="https://twitter.com/deepu105">Twitter</a> and <a href="https://www.linkedin.com/in/deepu05/">LinkedIn</a>.</p></div><hr><p>Post <strong>3</strong> of <strong>3</strong> in series <strong>"Microservices with JHipster"</strong>.</p><p></p><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="prev d-block col-md-6" rel="prev" href="/deploying-jhipster-microservices-on-azure-kubernetes-service-aks/">&laquo; Prev post in series</a><div class="clearfix"></div></div><div class="after-post-cats"><ul class="tags mb-4"></ul></div><div class="after-post-tags"><ul class="tags"><li><a class="smoothscroll" href="/tags#istio">#istio</a></li><li><a class="smoothscroll" href="/tags#java">#java</a></li><li><a class="smoothscroll" href="/tags#kubernetes">#kubernetes</a></li><li><a class="smoothscroll" href="/tags#microservices">#microservices</a></li></ul></div><div class="row PageNavigation d-flex justify-content-between font-weight-bold"><a class="prev d-block col-md-6" href="/make-the-most-out-of-vscode/">&laquo; My VS Code setup - Making the most out of VS Code</a> <a class="next d-block col-md-6 text-lg-right" href="/functional-programming-in-java-for-beginners/">7 Functional programming techniques in Java - A primer &raquo;</a><div class="clearfix"></div></div><hr></div></div></div></div><div class="alertbar"><div class="container text-center"><span>Never miss a story from Technorage, follow me on <a rel="me" target="_blank" href="https://mastodon.social/@deepu105">Mastodon</a>, <a rel="me" target="_blank" href="https://www.linkedin.com/in/deepu05">Linkedin</a> or <a rel="me" target="_blank" href="https://twitter.com/deepu105">Twitter</a>.<br><small>This site uses <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/cookie-usage#gtagjs_google_analytics_4_-_cookie_usage" target="_blank">Google Analytics cookies</a>. By using the site, you agree to their use.</small></span></div></div></div><div class="jumbotron fortags lozad" data-background-image="/assets/images/jumbotron.jpg"><div class="d-md-flex h-100"><div class="col-md-4 transpdark align-self-center text-center h-100"><div class="d-md-flex align-items-center justify-content-center h-100"><h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2></div></div><div class="col-md-8 pt-1 ph-2 align-self-center text-center h-100"><a class="mt-1 mb-1" href="/tags#languages">languages (15)</a> <a class="mt-1 mb-1" href="/tags#programming">programming (15)</a> <a class="mt-1 mb-1" href="/tags#java">java (13)</a> <a class="mt-1 mb-1" href="/tags#javascript">javascript (13)</a> <a class="mt-1 mb-1" href="/tags#rust">rust (9)</a> <a class="mt-1 mb-1" href="/tags#beginners">beginners (8)</a> <a class="mt-1 mb-1" href="/tags#concurrency">concurrency (7)</a> <a class="mt-1 mb-1" href="/tags#go">go (7)</a> <a class="mt-1 mb-1" href="/tags#linux">linux (6)</a> <a class="mt-1 mb-1" href="/tags#kubernetes">kubernetes (5)</a> <a class="mt-1 mb-1" href="/tags#microservices">microservices (5)</a> <a class="mt-1 mb-1" href="/tags#typescript">typescript (5)</a> <a class="mt-1 mb-1" href="/tags#computerscience">computerscience (4)</a> <a class="mt-1 mb-1" href="/tags#development">development (4)</a> <a class="mt-1 mb-1" href="/tags#fedora">fedora (4)</a> <a class="mt-1 mb-1" href="/tags#functional">functional (4)</a> <a class="mt-1 mb-1" href="/tags#thepragmaticprogrammer">thepragmaticprogrammer (4)</a> <a class="mt-1 mb-1" href="/tags#async">async (3)</a> <a class="mt-1 mb-1" href="/tags#jhipster">jhipster (3)</a> <a class="mt-1 mb-1" href="/tags#azure">azure (2)</a> <a class="mt-1 mb-1" href="/tags#career">career (2)</a> <a class="mt-1 mb-1" href="/tags#codequality">codequality (2)</a> <a class="mt-1 mb-1" href="/tags#deno">deno (2)</a> <a class="mt-1 mb-1" href="/tags#devops">devops (2)</a> <a class="mt-1 mb-1" href="/tags#discuss">discuss (2)</a> <a class="mt-1 mb-1" href="/tags#docker">docker (2)</a> <a class="mt-1 mb-1" href="/tags#garbagecollection">garbagecollection (2)</a> <a class="mt-1 mb-1" href="/tags#gnome">gnome (2)</a> <a class="mt-1 mb-1" href="/tags#golang">golang (2)</a> <a class="mt-1 mb-1" href="/tags#kde">kde (2)</a> <a class="mt-1 mb-1" href="/tags#node">node (2)</a> <a class="mt-1 mb-1" href="/tags#nodejs">nodejs (2)</a> <a class="mt-1 mb-1" href="/tags#openjdk">openjdk (2)</a> <a class="mt-1 mb-1" href="/tags#passkeys">passkeys (2)</a> <a class="mt-1 mb-1" href="/tags#react">react (2)</a> <a class="mt-1 mb-1" href="/tags#showdev">showdev (2)</a> <a class="mt-1 mb-1" href="/tags#terminal">terminal (2)</a> <a class="mt-1 mb-1" href="/tags#terraform">terraform (2)</a> <a class="mt-1 mb-1" href="/tags#webassembly">webassembly (2)</a> <a class="mt-1 mb-1" href="/tags#webauthn">webauthn (2)</a> <a class="mt-1 mb-1" href="/tags#webdev">webdev (2)</a> <a class="mt-1 mb-1" href="/tags#architecture">architecture (1)</a> <a class="mt-1 mb-1" href="/tags#aws">aws (1)</a> <a class="mt-1 mb-1" href="/tags#bash">bash (1)</a> <a class="mt-1 mb-1" href="/tags#blogging">blogging (1)</a> <a class="mt-1 mb-1" href="/tags#books">books (1)</a> <a class="mt-1 mb-1" href="/tags#clojure">clojure (1)</a> <a class="mt-1 mb-1" href="/tags#codenewbie">codenewbie (1)</a> <a class="mt-1 mb-1" href="/tags#desktop">desktop (1)</a> <a class="mt-1 mb-1" href="/tags#developerexperience">developerexperience (1)</a> <a class="mt-1 mb-1" href="/tags#devrel">devrel (1)</a> <a class="mt-1 mb-1" href="/tags#devsecops">devsecops (1)</a> <a class="mt-1 mb-1" href="/tags#distributedsystems">distributedsystems (1)</a> <a class="mt-1 mb-1" href="/tags#engineering">engineering (1)</a> <a class="mt-1 mb-1" href="/tags#gaming">gaming (1)</a> <a class="mt-1 mb-1" href="/tags#ide">ide (1)</a> <a class="mt-1 mb-1" href="/tags#interview">interview (1)</a> <a class="mt-1 mb-1" href="/tags#istio">istio (1)</a> <a class="mt-1 mb-1" href="/tags#jdk">jdk (1)</a> <a class="mt-1 mb-1" href="/tags#Jekyll">Jekyll (1)</a> <a class="mt-1 mb-1" href="/tags#js">js (1)</a> <a class="mt-1 mb-1" href="/tags#jvm">jvm (1)</a> <a class="mt-1 mb-1" href="/tags#kotlin">kotlin (1)</a> <a class="mt-1 mb-1" href="/tags#loom">loom (1)</a> <a class="mt-1 mb-1" href="/tags#macos">macos (1)</a> <a class="mt-1 mb-1" href="/tags#mastodon">mastodon (1)</a> <a class="mt-1 mb-1" href="/tags#medium">medium (1)</a> <a class="mt-1 mb-1" href="/tags#memory-management">memory-management (1)</a> <a class="mt-1 mb-1" href="/tags#motivation">motivation (1)</a> <a class="mt-1 mb-1" href="/tags#multithreading">multithreading (1)</a> <a class="mt-1 mb-1" href="/tags#ohmyzsh">ohmyzsh (1)</a> <a class="mt-1 mb-1" href="/tags#opensource">opensource (1)</a> <a class="mt-1 mb-1" href="/tags#patternmatching">patternmatching (1)</a> <a class="mt-1 mb-1" href="/tags#polyglot">polyglot (1)</a> <a class="mt-1 mb-1" href="/tags#pragmatic">pragmatic (1)</a> <a class="mt-1 mb-1" href="/tags#python">python (1)</a> <a class="mt-1 mb-1" href="/tags#ruby">ruby (1)</a> <a class="mt-1 mb-1" href="/tags#scala">scala (1)</a> <a class="mt-1 mb-1" href="/tags#security">security (1)</a> <a class="mt-1 mb-1" href="/tags#social">social (1)</a> <a class="mt-1 mb-1" href="/tags#spring">spring (1)</a> <a class="mt-1 mb-1" href="/tags#svelte">svelte (1)</a> <a class="mt-1 mb-1" href="/tags#tech">tech (1)</a> <a class="mt-1 mb-1" href="/tags#ubuntu">ubuntu (1)</a> <a class="mt-1 mb-1" href="/tags#v8">v8 (1)</a> <a class="mt-1 mb-1" href="/tags#vr">vr (1)</a> <a class="mt-1 mb-1" href="/tags#vscode">vscode (1)</a> <a class="mt-1 mb-1" href="/tags#web">web (1)</a> <a class="mt-1 mb-1" href="/tags#windows">windows (1)</a> <a class="mt-1 mb-1" href="/tags#womenintech">womenintech (1)</a> <a class="mt-1 mb-1" href="/tags#writing">writing (1)</a> <a class="mt-1 mb-1" href="/tags#zsh">zsh (1)</a></div></div></div><footer class="footer"><div class="container"><div class="row"><div class="col-md-6 col-sm-6 text-center text-lg-left">Copyright © 2024 Deepu K Sasidharan<br><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img class="lozad" alt="Creative Commons License" style="border-width:0" src="/assets/images/placeholder.jpg" data-src="https://i.creativecommons.org/l/by/4.0/88x31.png"> </a>Content licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</div><div class="col-md-6 col-sm-6 text-center text-lg-right"><a target="_blank" href="https://www.wowthemes.net/mediumish-free-jekyll-template/">Mediumish Jekyll Theme</a> by WowThemes.net | Domain by <a href="https://js.org" target="_blank" title="JS.ORG | JavaScript Community"><img src="/assets/images/placeholder.jpg" data-src="https://logo.js.org/dark_tiny.png" style="width:50px" alt="JS.ORG Logo" class="lozad"> </a>| Hosted with <i class="far fa-heart"></i> by <a href="https://pages.github.com/" target="_blank">Github</a></div></div></div></footer></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.slim.min.js" integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js" integrity="sha256-34Si1Y6llMBKM3G0jQILVeoQKEwuxjbk4zGWXXMT4ps=" crossorigin="anonymous"></script><script async src="/assets/js/lunrsearchengine.js"></script><script async src="/assets/js/mediumish.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js" integrity="sha256-hstwhDmGVwZjIwt6SlTG6sQBREWrWTBjVTik/JLlb1Y=" crossorigin="anonymous"></script><script>// lazy loads images
    const lazyloadObserver = lozad()
    lazyloadObserver.observe();</script><script async src="/assets/js/ie10-viewport-bug-workaround.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1SDSM5NX07"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("consent","default",{ad_user_data:"denied",ad_personalization:"denied",ad_storage:"denied",analytics_storage:"granted"}),gtag("js",new Date),gtag("config","G-1SDSM5NX07")</script></body></html>